<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin Login</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>Admin Login</h1>
</header>

<div class="login-box">
  <button id="loginBtn">Login with Google</button>
  <p id="loginMsg"></p>
</div>

<script type="module">
  import { auth, db } from "./firebase.js";
  import { GoogleAuthProvider, signInWithPopup } from
    "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { doc, getDoc } from
    "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const provider = new GoogleAuthProvider();
  const msg = document.getElementById("loginMsg");

  document.getElementById("loginBtn").onclick = async () => {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;

      const adminRef = doc(db, "admins", user.uid);
      const adminSnap = await getDoc(adminRef);

      if (adminSnap.exists()) {
        window.location.href = "admin.html";
      } else {
        msg.innerText = "‚ùå Not an admin";
      }
    } catch (e) {
      msg.innerText = e.message;
    }
  };
</script>

</body>
</html>
