<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Players Groups</title>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { text-align: center; }
    table { width: 45%; border-collapse: collapse; margin: 10px; float: left; }
    th, td { border: 1px solid black; padding: 8px; text-align: center; }
    th { background: #f4f4f4; }
    button { margin: 20px; padding: 10px 15px; cursor: pointer; }
  </style>
</head>
<body>

  <h2>Player Groups</h2>
  <button onclick="shuffleAndSave()">Shuffle & Save Groups</button>
  
  <div>
    <table id="groupA">
      <thead>
        <tr><th colspan="2">Group A</th></tr>
        <tr><th>Player</th><th>Points</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <table id="groupB">
      <thead>
        <tr><th colspan="2">Group B</th></tr>
        <tr><th>Player</th><th>Points</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script type="module">
    // Your Firebase config (replace with your values!)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const players = [
      "Aravind", "Tharun", "Amal", "Devarag", "Abhinav", "Ram Govind",
      "Akash", "Kiran", "Sajan", "Unni", "Jesfin", "Thab"
    ];

    // Shuffle helper
    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    // Shuffle players, split into two groups, save to Firestore
    async function shuffleAndSave() {
      const shuffled = shuffle([...players]);
      const mid = Math.ceil(shuffled.length / 2);
      const groupA = shuffled.slice(0, mid);
      const groupB = shuffled.slice(mid);

      // Save to Firestore
      const batch = db.batch();
      groupA.forEach(name => {
        const ref = db.collection("players").doc(name);
        batch.set(ref, { name, group: "A", points: 0 });
      });
      groupB.forEach(name => {
        const ref = db.collection("players").doc(name);
        batch.set(ref, { name, group: "B", points: 0 });
      });
      await batch.commit();

      alert("Groups saved to Firestore âœ…");
    }

    // Live listener: updates tables whenever Firestore changes
    db.collection("players").orderBy("points", "desc").onSnapshot(snapshot => {
      const groupA = document.querySelector("#groupA tbody");
      const groupB = document.querySelector("#groupB tbody");
      groupA.innerHTML = "";
      groupB.innerHTML = "";

      snapshot.forEach(doc => {
        const player = doc.data();
        const row = `<tr><td>${player.name}</td><td>${player.points}</td></tr>`;
        if (player.group === "A") {
          groupA.innerHTML += row;
        } else {
          groupB.innerHTML += row;
        }
      });
    });
  </script>
</body>
</html>


